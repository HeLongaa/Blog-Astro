---
// FriendLinkForm.astro - Astro组件封装友链提交表单
import Layout from "../layouts/Layout.astro";
---

<Layout title="友情链接">
    <main class="container mx-auto px-4 py-8">
        <h1 class="text-3xl font-bold mb-6">友情链接</h1>

        <div class="mb-8">
            <p class="mb-4">
                欢迎与本站交换友链！请填写下方表单提交您的网站信息。
            </p>
            <p class="mb-4">友链要求：</p>
            <ul class="list-disc pl-6 mb-6">
                <li>网站内容健康，无违法违规内容</li>
                <li>网站稳定，可以正常访问</li>
                <li>网站有一定的原创内容</li>
                <li>网站设计美观，用户体验良好</li>
            </ul>
        </div>

        <div id="friend-link-container" class="mb-10"></div>

        <h2 class="text-2xl font-bold mb-4">我的友链</h2>
        <p class="mb-4">您可以使用以下信息添加本站到您的友链：</p>

        <div class="bg-gray-100 dark:bg-gray-800 p-4 rounded-lg mb-8">
            <p><strong>名称：</strong>您的博客名称</p>
            <p><strong>链接：</strong>https://your-blog-url.com</p>
            <p><strong>头像：</strong>https://your-blog-url.com/avatar.png</p>
            <p><strong>描述：</strong>您的博客简短描述</p>
        </div>
    </main>
</Layout>

<script>
    // 动态导入React和ReactDOM
    import React from "react";
    import ReactDOM from "react-dom";

    // 导入友链表单组件
    import { FriendLinkSubmitter } from "../components/FriendLinkSubmitter";

    // 当文档加载完成后挂载组件
    document.addEventListener("DOMContentLoaded", () => {
        const container = document.getElementById("friend-link-container");
        if (container) {
            // 检测网站是否处于暗色模式
            const isDarkMode =
                document.documentElement.classList.contains("dark") ||
                document.documentElement.getAttribute("data-theme") === "dark";

            ReactDOM.render(
                React.createElement(FriendLinkSubmitter, {
                    apiEndpoint: "/api/submit",
                    repoOwner: "YourGithubUsername", // 替换为您的GitHub用户名
                    repoName: "YourRepoName", // 替换为您的仓库名
                    theme: isDarkMode ? "dark" : "light",
                    onSuccess: (data) => {
                        // 可以添加成功提交后的自定义处理逻辑
                        console.log("友链提交成功:", data);
                    },
                    onError: (error) => {
                        // 可以添加提交失败后的自定义处理逻辑
                        console.error("友链提交失败:", error);
                    },
                }),
                container,
            );
        }
    });
</script>
